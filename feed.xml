<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://anandsr724.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://anandsr724.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-10-11T18:54:07+00:00</updated><id>https://anandsr724.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Solving Handwritten Equations with Deep Learning</title><link href="https://anandsr724.github.io/blog/2024/solving_handwritten_equations_using_deep_learning/" rel="alternate" type="text/html" title="Solving Handwritten Equations with Deep Learning"/><published>2024-08-18T16:40:16+00:00</published><updated>2024-08-18T16:40:16+00:00</updated><id>https://anandsr724.github.io/blog/2024/solving_handwritten_equations_using_deep_learning</id><content type="html" xml:base="https://anandsr724.github.io/blog/2024/solving_handwritten_equations_using_deep_learning/"><![CDATA[<p>In today’s digital age, machine learning (ML) has revolutionized numerous fields, including image recognition and natural language processing. One intriguing problem that combines both these areas is the automatic solving of handwritten mathematical equations. Imagine taking a picture of a complex equation and having a machine instantly provide the solution. This blog post delves into how I built a machine learning model to achieve just that.</p> <h4 id="problem-statement">Problem Statement</h4> <p>The task at hand is to develop a system that can take an image of a handwritten mathematical equation and output the correct answer.</p> <h3 id="to-tackle-this-the-problem-can-be-broken-down-into-two-primary-components">To tackle this, the problem can be broken down into two primary components:</h3> <ul> <li>Reading and detecting the symbols: The system must recognize individual numbers and mathematical symbols from the image.</li> <li>Solving the equation: Once the symbols are identified, the system must correctly interpret and solve the equation.</li> </ul> <h3 id="symbol-detection-with-convolutional-neural-networks-cnns">Symbol Detection with Convolutional Neural Networks (CNNs)</h3> <p>The first step is to accurately recognize the symbols in the image. We’ll use a Convolutional Neural Network (CNN) for this purpose, as CNNs are particularly effective for image classification tasks.</p> <h2 id="code-blocks">Code Blocks</h2> <p><strong>Target Classes:</strong> We consider the following symbols and functions for our model:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">classes_ideal</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">(</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">)</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">4</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">5</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">6</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">9</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">[</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">]</span><span class="sh">'</span><span class="p">,</span>
<span class="sh">'</span><span class="s">cos</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">e</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">forward_slash</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">log</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pi</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">sin</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">sqrt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">tan</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">times</span><span class="sh">'</span><span class="p">]</span></code></pre></figure> <p>These symbols cover a broad range of arithmetic operations and functions commonly used in mathematical equations.</p> <h3 id="dataset">Dataset</h3> <p>For the dataset, I used a publicly available dataset on Kaggle. You can find the dataset <a href="https://www.kaggle.com/datasets/xainano/handwrittenmathsymbols">here</a> .</p> <p>Analyzing the dataset, we noticed an imbalance in the number of images per class. For instance, some classes like ( and ) had only 700 images, while others like 1, 2, and 5 had a significantly larger number of images.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/class_distribution-480.webp 480w,/assets/blogs_media/blog1/class_distribution-800.webp 800w,/assets/blogs_media/blog1/class_distribution-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/class_distribution.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>To address this imbalance, we applied data augmentation techniques to increase the number of images for underrepresented classes.</p> <h3 id="data-augmentation">Data Augmentation</h3> <p>Using the ImageDataGenerator from TensorFlow, we augmented our data with the following parameters:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">datagen</span> <span class="o">=</span> <span class="nc">ImageDataGenerator</span><span class="p">(</span>
<span class="n">zoom_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
<span class="n">width_shift_range</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span>
<span class="n">height_shift_range</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span>
<span class="n">fill_mode</span><span class="o">=</span><span class="sh">'</span><span class="s">constant</span><span class="sh">'</span><span class="p">,</span>
<span class="n">cval</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
<span class="n">channel_shift_range</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span>
<span class="p">)</span></code></pre></figure> <p>For certain symbols like /, we generated 10 new images from each original image, whereas for others, we generated 2 new images from each.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/aug2-480.webp 480w,/assets/blogs_media/blog1/aug2-800.webp 800w,/assets/blogs_media/blog1/aug2-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/aug2.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="image-preprocessing">Image Preprocessing</h3> <p>Images were resized and converted to grayscale before being fed into the model:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">load_image</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="nf">read_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">image</span><span class="p">.</span><span class="nf">decode_jpeg</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">image</span><span class="p">.</span><span class="nf">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">45</span><span class="p">))</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">image</span><span class="p">.</span><span class="nf">rgb_to_grayscale</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span></code></pre></figure> <h3 id="model-architecture">Model Architecture</h3> <p>The CNN model was designed with several convolutional layers, followed by dense layers for classification. Here are some key terms and parameters used in our model:</p> <ul> <li>Convolutional Layer: Applies convolution operations to the input, extracting features.</li> <li>Filter, Padding, Kernel Size, Strides, Activation: Key parameters for convolutional layers.</li> <li>Flatten Layer: Converts the 2D matrix data to a vector.</li> <li>Dense Layer: A fully connected layer for classification.</li> <li>Kernel Initializer, Regularization, Dropout: Techniques to prevent overfitting and improve generalization.</li> <li>Optimizer, Loss Function: Used for training the model.</li> </ul> <p>Here is the architecture of the CNN model:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">model</span> <span class="o">=</span> <span class="nc">Sequential</span><span class="p">([</span>
<span class="n">keras</span><span class="p">.</span><span class="nc">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
<span class="nc">Rescaling</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">),</span>
<span class="nc">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="sh">'</span><span class="s">same</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">,</span>
<span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">),</span>
<span class="nc">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="sh">'</span><span class="s">same</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">,</span>
<span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">),</span>
<span class="nc">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="sh">'</span><span class="s">same</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">,</span>
<span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">),</span>
<span class="nc">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="sh">'</span><span class="s">same</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">,</span>
<span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">),</span>
<span class="nc">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="sh">'</span><span class="s">same</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">,</span>
<span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">),</span>
<span class="nc">Flatten</span><span class="p">(),</span>
<span class="nc">Dense</span><span class="p">(</span><span class="mi">768</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">,</span>
<span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">regularizers</span><span class="p">.</span><span class="nf">l2</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)),</span>
<span class="nc">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
<span class="nc">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">,</span>
<span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">regularizers</span><span class="p">.</span><span class="nf">l2</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)),</span>
<span class="nc">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
<span class="nc">Dense</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">softmax</span><span class="sh">'</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">glorot_uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="sh">'</span><span class="s">zeros</span><span class="sh">'</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">model</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="sh">'</span><span class="s">sparse_categorical_crossentropy</span><span class="sh">'</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="sh">'</span><span class="s">adam</span><span class="sh">'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">])</span>
<span class="n">model</span><span class="p">.</span><span class="nf">summary</span><span class="p">()</span></code></pre></figure> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/Model_architecture-480.webp 480w,/assets/blogs_media/blog1/Model_architecture-800.webp 800w,/assets/blogs_media/blog1/Model_architecture-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/Model_architecture.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Before going to the evaluation , lets try to visualize how Convolutional layers really work</p> <p>This is what the output from the 2nd convolutional layer looks like:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/all_symbols_conv-480.webp 480w,/assets/blogs_media/blog1/all_symbols_conv-800.webp 800w,/assets/blogs_media/blog1/all_symbols_conv-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/all_symbols_conv.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Lets take an example of + and x symbols and try to understand how the convolutional layer are</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/complete_visualization_plus_times-480.webp 480w,/assets/blogs_media/blog1/complete_visualization_plus_times-800.webp 800w,/assets/blogs_media/blog1/complete_visualization_plus_times-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/complete_visualization_plus_times.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>If we observe the 4th convolutional layer , we can see how the is detecting the slat line with this particular filter , as it is detecting a diagonal in the x and nothing for the + symbol.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/anno_complete_visualization_plus_times-480.webp 480w,/assets/blogs_media/blog1/anno_complete_visualization_plus_times-800.webp 800w,/assets/blogs_media/blog1/anno_complete_visualization_plus_times-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/anno_complete_visualization_plus_times.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="training-and-evaluation">Training and Evaluation</h3> <p>After training the model, we evaluated its performance using various metrics like accuracy and loss. Below are the training statistics and the confusion matrix.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/confusion_matrix-480.webp 480w,/assets/blogs_media/blog1/confusion_matrix-800.webp 800w,/assets/blogs_media/blog1/confusion_matrix-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/confusion_matrix.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Dataset was not very good hence the model does perform well in the validation set , but it performs decently good with real life data , Hence we will move ahead with this model.</p> <h3 id="solving-the-equation">Solving the Equation</h3> <p>With our model ready to classify individual mathematical symbols, we now focus on solving the entire equation. This involves segmenting the image to isolate each symbol.</p> <ul> <li> <p>Image Segmentation with OpenCV: Using OpenCV, we can detect and crop individual symbols from the equation image. Here are some key techniques used:</p> </li> <li>Filters: To enhance image features. Bounding Boxes: To identify and isolate symbols.</li> <li>Contours: To detect the boundaries of symbols.</li> </ul> <p>Now that we have the model to classify the symbols given a single image of the symbol but the input we are going to receive will be the image of the whole equation.</p> <p>We will have to crop the image into different sections containing single symbols then input these image to our model.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/bounding_box_viz_2-480.webp 480w,/assets/blogs_media/blog1/bounding_box_viz_2-800.webp 800w,/assets/blogs_media/blog1/bounding_box_viz_2-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/bounding_box_viz_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>this technique of cropping the image based on the requirement is known as image segmentation</p> <p>First we import the image then we convert it to grayscale , after converting to grayscale we apply adaptiveThreshold to the image , based on the contours generated from the image the bounding boxes are generated</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/opencv_parent-480.webp 480w,/assets/blogs_media/blog1/opencv_parent-800.webp 800w,/assets/blogs_media/blog1/opencv_parent-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/opencv_parent.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/opencv_theshold-480.webp 480w,/assets/blogs_media/blog1/opencv_theshold-800.webp 800w,/assets/blogs_media/blog1/opencv_theshold-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/opencv_theshold.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/bounding_box_viz5-480.webp 480w,/assets/blogs_media/blog1/bounding_box_viz5-800.webp 800w,/assets/blogs_media/blog1/bounding_box_viz5-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/bounding_box_viz5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="interpreting-and-solving-the-equation">Interpreting and Solving the Equation</h3> <p>After segmenting the image and recognizing the symbols, we convert the sequence into a mathematical expression.</p> <p>For this I created a class in python “Mathsymbol“ library helps in parsing and evaluating these expressions.</p> <p>However, we must handle certain complexities , that we need to handle with the help of the custom class that we created:</p> <p>Powers: Correctly parsing and solving expressions with exponents.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/1_13-480.webp 480w,/assets/blogs_media/blog1/1_13-800.webp 800w,/assets/blogs_media/blog1/1_13-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/1_13.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>For example for the above image our model after doing the image segmentation will give this output,</p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">+</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">3</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">9</span><span class="dl">'</span><span class="p">]</span>
</code></pre></div></div> <p>we will have to somehow mention that the 3 was raised to the power of 4. For this we can do one thing , notice how the vertical position of the digits that are raised to the power will be lower that compared to the rest of the symbols</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/bounding_box_viz3-480.webp 480w,/assets/blogs_media/blog1/bounding_box_viz3-800.webp 800w,/assets/blogs_media/blog1/bounding_box_viz3-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/bounding_box_viz3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Using this logic we label all the symbols as either pow or gr , pow for the symbols that are raised to the power</p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Hence</span> <span class="nx">the</span> <span class="nx">equation</span> <span class="nx">becomes</span> <span class="k">from</span> <span class="k">this</span> <span class="nx">to</span> 
<span class="p">[</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">+</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">3</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">9</span><span class="dl">'</span><span class="p">]</span>
<span class="k">this</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">9</span>
</code></pre></div></div> <p>Multiple Digits: Properly identifying and combining multiple digits.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/1_14-480.webp 480w,/assets/blogs_media/blog1/1_14-800.webp 800w,/assets/blogs_media/blog1/1_14-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/1_14.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>For example for the above image our model after doing the image segmentation will give this output,</p> <p>look how the 9,6 in 96 and 4,9 in 49 are separated to combine the digits we will use a simple logic that if the combine all the adjacent number if they have the same symbol type (either pow or gr)</p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="dl">'</span><span class="s1">9</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">6</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">+</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">(</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">9</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">sqrt</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">e</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">)</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">forward_slash</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">]</span>
<span class="p">[</span><span class="dl">'</span><span class="s1">96</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">+</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">(</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">49</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">sqrt</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">e</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">)</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">forward_slash</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">]</span>

<span class="nx">final</span> <span class="nx">eq</span> <span class="nx">is</span>  <span class="mi">96</span><span class="o">+</span><span class="p">(</span><span class="mi">49</span><span class="o">-</span><span class="nx">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="nx">math</span><span class="p">.</span><span class="nx">e</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="nx">final</span> <span class="nx">ans</span> <span class="nx">is</span>  <span class="mf">119.67563936464994</span>
</code></pre></div></div> <p>Square Roots: Accurately interpreting square root symbols.</p> <p>Consider this image</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blogs_media/blog1/bounding_box_viz-480.webp 480w,/assets/blogs_media/blog1/bounding_box_viz-800.webp 800w,/assets/blogs_media/blog1/bounding_box_viz-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/blogs_media/blog1/bounding_box_viz.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>This is the output we will get , now we need to mention which symbols are to be considered inside the square root , for this we simply consider all the symbols that fall under the x coordinate of the square root to be inside the square root , hence in the above equation 16+9 will come under the square root</p> <div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">From</span> <span class="k">this</span> 
<span class="p">[</span><span class="dl">'</span><span class="s1">9</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">3</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">+</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">sqrt</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">6</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">+</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">9</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">7</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">]</span>
 <span class="nx">we</span> <span class="kd">get</span> <span class="k">this</span> <span class="o">-&gt;</span> <span class="mi">93</span><span class="o">+</span><span class="nx">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="mi">16</span><span class="o">+</span><span class="mi">9</span><span class="p">)</span><span class="o">-</span><span class="mi">7</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div></div> <hr/> <h3 id="conclusion">Conclusion</h3> <p>By combining convolutional neural networks for symbol recognition with image segmentation techniques, we can build an efficient system for solving handwritten mathematical equations. This project showcases the power of machine learning in automating complex tasks and has practical applications in educational tools, digitizing handwritten notes, and more.</p> <p>Thank you for reading! Feel free to explore the code and dataset linked above, and happy coding!</p>]]></content><author><name></name></author><category term="project-blog"/><category term="compputer-vision"/><category term="math"/><summary type="html"><![CDATA[A Step-by-Step Guide]]></summary></entry><entry><title type="html">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</title><link href="https://anandsr724.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/" rel="alternate" type="text/html" title="Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra"/><published>2024-05-14T00:00:00+00:00</published><updated>2024-05-14T00:00:00+00:00</updated><id>https://anandsr724.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra</id><content type="html" xml:base="https://anandsr724.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/"><![CDATA[]]></content><author><name></name></author><summary type="html"><![CDATA[We’re sharing updates across our Gemini family of models and a glimpse of Project Astra, our vision for the future of AI assistants.]]></summary></entry><entry><title type="html">Displaying External Posts on Your al-folio Blog</title><link href="https://anandsr724.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/" rel="alternate" type="text/html" title="Displaying External Posts on Your al-folio Blog"/><published>2022-04-23T23:20:09+00:00</published><updated>2022-04-23T23:20:09+00:00</updated><id>https://anandsr724.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog</id><content type="html" xml:base="https://anandsr724.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/"><![CDATA[]]></content><author><name></name></author></entry></feed>